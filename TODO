- potentiel use after free if both timeout and user handle happened at the same time
- clean up code ? 
- maybe do some optimization for the heap allocation 
